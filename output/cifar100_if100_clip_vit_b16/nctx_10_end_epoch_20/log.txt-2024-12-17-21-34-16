** Config **
backbone: clip_vit_b16
ctp: end
ctx_init: a photo of a
dataset: cifar100_if100
lr: 0.002
momentum: 0.9
n_ctx: 10
num_epochs: 20
num_workers: 16
output_dir: ./output/cifar100_if100_clip_vit_b16/nctx_10_end_epoch_20
seed: 1
test_batch_size: 1024
test_img_path: /home/bowei/Desktop/PyProjs/myb1/CLIP-B-16_pkl/cifar100_test_features.pkl
test_only: False
train_batch_size: 1024
train_img_path: /home/bowei/Desktop/PyProjs/myb1/CLIP-B-16_pkl/cifar100_r100_100train_features.pkl
weight_decay: 0.0005
*************
Setting fixed seed: 1
Building model
Loading CLIP (backbone: clip_vit_b16)
Epoch 1/20, Train Loss: 1.1677, Train Accuracy: 0.7029, Test Accuracy: 0.6812
Epoch 2/20, Train Loss: 0.9252, Train Accuracy: 0.7468, Test Accuracy: 0.6750
Epoch 3/20, Train Loss: 0.8075, Train Accuracy: 0.7722, Test Accuracy: 0.6631
Epoch 4/20, Train Loss: 0.7372, Train Accuracy: 0.7880, Test Accuracy: 0.6550
Epoch 5/20, Train Loss: 0.7055, Train Accuracy: 0.7975, Test Accuracy: 0.6694
Epoch 6/20, Train Loss: 0.6775, Train Accuracy: 0.8032, Test Accuracy: 0.6603
Epoch 7/20, Train Loss: 0.6628, Train Accuracy: 0.8065, Test Accuracy: 0.6634
Epoch 8/20, Train Loss: 0.6557, Train Accuracy: 0.8098, Test Accuracy: 0.6707
Epoch 9/20, Train Loss: 0.6401, Train Accuracy: 0.8131, Test Accuracy: 0.6632
Epoch 10/20, Train Loss: 0.6253, Train Accuracy: 0.8137, Test Accuracy: 0.6763
Epoch 11/20, Train Loss: 0.6204, Train Accuracy: 0.8170, Test Accuracy: 0.6628
Epoch 12/20, Train Loss: 0.6215, Train Accuracy: 0.8171, Test Accuracy: 0.6626
Epoch 13/20, Train Loss: 0.6132, Train Accuracy: 0.8182, Test Accuracy: 0.6723
Epoch 14/20, Train Loss: 0.6067, Train Accuracy: 0.8208, Test Accuracy: 0.6691
Epoch 15/20, Train Loss: 0.5980, Train Accuracy: 0.8224, Test Accuracy: 0.6723
Epoch 16/20, Train Loss: 0.5944, Train Accuracy: 0.8247, Test Accuracy: 0.6688
Epoch 17/20, Train Loss: 0.5907, Train Accuracy: 0.8241, Test Accuracy: 0.6715
Epoch 18/20, Train Loss: 0.5884, Train Accuracy: 0.8250, Test Accuracy: 0.6709
Epoch 19/20, Train Loss: 0.5871, Train Accuracy: 0.8256, Test Accuracy: 0.6709
Epoch 20/20, Train Loss: 0.5861, Train Accuracy: 0.8258, Test Accuracy: 0.6713
Best Test Accuracy: 0.6812 at Epoch 1
Accuracy of apple: 0.9700
Accuracy of aquarium_fish: 0.9300
Accuracy of baby: 0.8600
Accuracy of bear: 0.7400
Accuracy of beaver: 0.4200
Accuracy of bed: 0.8100
Accuracy of bee: 0.8000
Accuracy of beetle: 0.7800
Accuracy of bicycle: 0.8800
Accuracy of bottle: 0.9000
Accuracy of bowl: 0.4900
Accuracy of boy: 0.6700
Accuracy of bridge: 0.8500
Accuracy of bus: 0.7200
Accuracy of butterfly: 0.6200
Accuracy of camel: 0.9000
Accuracy of can: 0.8600
Accuracy of castle: 0.8300
Accuracy of caterpillar: 0.3600
Accuracy of cattle: 0.8500
Accuracy of chair: 0.9600
Accuracy of chimpanzee: 0.8600
Accuracy of clock: 0.8700
Accuracy of cloud: 0.7900
Accuracy of cockroach: 0.4500
Accuracy of couch: 0.6000
Accuracy of crab: 0.6200
Accuracy of crocodile: 0.2200
Accuracy of cup: 0.8200
Accuracy of dinosaur: 0.6800
Accuracy of dolphin: 0.6900
Accuracy of elephant: 0.8500
Accuracy of flatfish: 0.2800
Accuracy of forest: 0.6900
Accuracy of fox: 0.8200
Accuracy of girl: 0.6900
Accuracy of hamster: 0.8000
Accuracy of house: 0.9100
Accuracy of kangaroo: 0.7100
Accuracy of keyboard: 0.9000
Accuracy of lamp: 0.7900
Accuracy of lawn_mower: 0.9200
Accuracy of leopard: 0.1800
Accuracy of lion: 0.8300
Accuracy of lizard: 0.4700
Accuracy of lobster: 0.2100
Accuracy of man: 0.7600
Accuracy of maple_tree: 0.3200
Accuracy of motorcycle: 0.8900
Accuracy of mountain: 0.9700
Accuracy of mouse: 0.4000
Accuracy of mushroom: 0.7500
Accuracy of oak_tree: 0.6100
Accuracy of orange: 0.9800
Accuracy of orchid: 0.9000
Accuracy of otter: 0.3700
Accuracy of palm_tree: 0.8700
Accuracy of pear: 0.7000
Accuracy of pickup_truck: 0.9400
Accuracy of pine_tree: 0.7100
Accuracy of plain: 0.5900
Accuracy of plate: 0.4100
Accuracy of poppy: 0.7500
Accuracy of porcupine: 0.1500
Accuracy of possum: 0.4500
Accuracy of rabbit: 0.7800
Accuracy of raccoon: 0.7400
Accuracy of ray: 0.2000
Accuracy of road: 0.9500
Accuracy of rocket: 0.8900
Accuracy of rose: 0.8000
Accuracy of sea: 0.8600
Accuracy of seal: 0.4000
Accuracy of shark: 0.6500
Accuracy of shrew: 0.4500
Accuracy of skunk: 0.6500
Accuracy of skyscraper: 0.7300
Accuracy of snail: 0.6300
Accuracy of snake: 0.6400
Accuracy of spider: 0.5400
Accuracy of squirrel: 0.5500
Accuracy of streetcar: 0.5100
Accuracy of sunflower: 0.9300
Accuracy of sweet_pepper: 0.6600
Accuracy of table: 0.7700
Accuracy of tank: 0.8000
Accuracy of telephone: 0.0300
Accuracy of television: 0.7300
Accuracy of tiger: 0.4900
Accuracy of tractor: 0.8600
Accuracy of train: 0.8200
Accuracy of trout: 0.2000
Accuracy of tulip: 0.7200
Accuracy of turtle: 0.5400
Accuracy of wardrobe: 0.7200
Accuracy of whale: 0.6600
Accuracy of willow_tree: 0.6400
Accuracy of wolf: 0.7900
Accuracy of woman: 0.5900
Accuracy of worm: 0.8400
[0.97, 0.93, 0.86, 0.74, 0.42, 0.81, 0.8, 0.78, 0.88, 0.9, 0.49, 0.67, 0.85, 0.72, 0.62, 0.9, 0.86, 0.83, 0.36, 0.85, 0.96, 0.86, 0.87, 0.79, 0.45, 0.6, 0.62, 0.22, 0.82, 0.68, 0.69, 0.85, 0.28, 0.69, 0.82, 0.69, 0.8, 0.91, 0.71, 0.9, 0.79, 0.92, 0.18, 0.83, 0.47, 0.21, 0.76, 0.32, 0.89, 0.97, 0.4, 0.75, 0.61, 0.98, 0.9, 0.37, 0.87, 0.7, 0.94, 0.71, 0.59, 0.41, 0.75, 0.15, 0.45, 0.78, 0.74, 0.2, 0.95, 0.89, 0.8, 0.86, 0.4, 0.65, 0.45, 0.65, 0.73, 0.63, 0.64, 0.54, 0.55, 0.51, 0.93, 0.66, 0.77, 0.8, 0.03, 0.73, 0.49, 0.86, 0.82, 0.2, 0.72, 0.54, 0.72, 0.66, 0.64, 0.79, 0.59, 0.84]
average accuracy is: 0.6813
